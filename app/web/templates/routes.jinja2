{% extends "_layout.jinja2" %}

{% block content %}
<h1>Routes</h1>

<!-- List of existing routes -->
<table>
    <thead>
        <tr>
            <th>Domain</th>
            <th>Path</th>
            <th>Hosts</th>
            <th>Backend Path</th>
            <th>Active</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for route in routes %}
        <tr>
            <td style="text-align: right;">{{ route.subdomain }}.{{ route.domain.name }}</td>
            <td>{{ route.path_prefix }}</td>
            <td>
                {% for host in route.hosts %}
                    {{ route.protocol | lower }}://{{ host.host }}<br>
                {% endfor %}
            </td>
            <td>{{ route.backend_path }}</td>
            <td>
                <a href="{{ url_for('toggle_route', route_id=route.id) }}">
                    {{ route.active }}
                </a>
            </td>
            <td>
                <a href="{{ url_for('edit_route', route_id=route.id) }}">Edit</a>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7">No routes found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Form to add a new route -->
<h2>Add New Route</h2>
<form method="post" action="{{ url_for('create_route') }}">
    <div>
        <label for="subdomain">Subdomain:</label>
        <input type="text" id="subdomain" name="subdomain">
    </div>
    <div>
        <label for="domain_id">Domain:</label>
        <select id="domain_id" name="domain_id">
            {% for domain in domains %}
            <option value="{{ domain.id }}">{{ domain.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label for="protocol">Protocol:</label>
        <select id="protocol" name="protocol">
            {% for proto in protocols %}
            <option value="{{ proto }}">{{ proto }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label for="path_prefix">Path:</label>
        <input type="text" id="path_prefix" name="path_prefix" value="/">
    </div>
    <div>
        <label for="backend_path">Backend Path:</label>
        <input type="text" id="backend_path" name="backend_path">
    </div>
    <button type="submit">Add Route</button>
</form>
{% endblock %}